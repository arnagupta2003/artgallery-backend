import{$ as ee,$a as ne,$c as we,Ae as W,Ag as gi,B as St,Be as tt,Bf as dt,C as l,Cb as jt,Ce as it,Cf as $e,D as m,De as nt,E as C,Eb as Xe,Ee as rt,Ef as ri,F as D,Fa as wt,Fb as Te,Fg as xe,G as S,Ga as F,Ge as pe,Gf as oi,Ha as ie,Hc as A,He as Ae,Hg as Ci,I as T,Ia as At,Ie as ot,If as J,J as y,Ja as Gt,Jb as le,Jf as _e,K as u,Ka as Se,Kb as Fe,Kc as et,Kf as ge,La as $t,Le as ce,Lf as Ce,Lg as ct,Mb as Ee,Me as ii,Mf as fe,Mg as ut,Na as z,Nc as Be,Nf as ai,O as It,Oa as Qe,Oc as Pe,P as Tt,Pa as Nt,Q as Ft,Qg as _t,R as j,Ra as kt,Rf as si,Rg as fi,S as p,Sf as Ne,T as I,Ta as Ie,Tf as mt,U as g,Ua as ze,Ub as Je,Vb as Ze,Vf as he,Vg as gt,W as He,Wa as Mt,Wb as qt,Wf as ke,X as je,Xa as Y,Xf as Me,Y as qe,Z as We,Za as Ot,Zg as Le,aa as P,ab as M,ad as Kt,bc as U,bd as Xt,be as Zt,bg as ve,c as yt,cb as Ye,cd as Jt,ce as ei,cg as li,d as Ue,db as Lt,dc as Wt,dg as di,ea as a,eg as mi,eh as Ct,f as bt,fa as d,g as h,ga as E,gb as re,h as v,hf as ue,ia as q,ig as pi,j as k,ja as De,jb as Vt,jg as ye,lb as Di,ma as te,mf as ni,n as r,na as O,nb as Rt,ne as ti,oa as Et,ob as Ut,oe as L,pa as Bt,pb as Ke,q as x,qa as Pt,qb as oe,qg as Oe,r as xt,rb as Ht,rg as be,s as w,sb as $,t as Dt,ta as V,uc as Qt,ug as ci,vb as ae,vc as zt,vg as ui,w as Z,wb as R,wf as Ge,wg as _i,x as _,xb as K,xc as Yt,xe as X,xf as at,xg as pt,yb as se,ye as de,yf as st,z as o,ze as me,zf as lt}from"./chunk-KEHI5R4L.js";import{a as N,b as Q,c as vt,g as xi}from"./chunk-BAF7YKD7.js";var hi=xi(Di(),1);function Si(t,s){t&1&&(D(0),C(1,"clr-icon",1),p(2),a(3,"translate"),S()),t&2&&(r(2),g(" ",d(3,1,"customer.verified")," "))}function Ii(t,s){t&1&&(D(0),C(1,"clr-icon",2),p(2),a(3,"translate"),S()),t&2&&(r(2),g(" ",d(3,1,"customer.registered")," "))}function Ti(t,s){if(t&1&&(l(0,"vdr-chip"),_(1,Si,4,3,"ng-container",0)(2,Ii,4,3,"ng-container",0),m()),t&2){let e=u();r(),o("ngIf",e.customer.user==null?null:e.customer.user.verified),r(),o("ngIf",!(e.customer.user!=null&&e.customer.user.verified))}}function Fi(t,s){t&1&&(l(0,"vdr-chip"),p(1),a(2,"translate"),m()),t&2&&(r(),I(d(2,1,"customer.guest")))}var Ei=t=>["/customer/customers",t];function Bi(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.id," ")}}function Pi(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.createdAt,"short")," ")}}function wi(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.createdAt,"short")," ")}}function Ai(t,s){if(t&1&&(l(0,"a",9)(1,"span"),p(2),m(),C(3,"clr-icon",10),m()),t&2){let e=s.item;o("routerLink",P(4,Ei,e.id)),r(2),He(" ",e.title," ",e.firstName," ",e.lastName," ")}}function Gi(t,s){if(t&1&&C(0,"vdr-customer-status-label",11),t&2){let e=s.item;o("customer",e)}}function $i(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.emailAddress," ")}}var Ve=t=>({groupName:t}),vi=t=>({count:t});function Ni(t,s){if(t&1&&(p(0),a(1,"translate")),t&2){let e=u();g(" ",E(1,1,"customer.add-customers-to-group-with-name",P(4,Ve,e.group.name)),`
`)}}function ki(t,s){if(t&1){let e=T();l(0,"button",3),y("click",function(){h(e);let n=u();return v(n.cancel())}),p(1),a(2,"translate"),m(),l(3,"button",4),y("click",function(){h(e);let n=u();return v(n.add())}),p(4),a(5,"translate"),m()}if(t&2){let e=u();r(),I(d(2,3,"common.cancel")),r(2),o("disabled",!e.selectedCustomerIds.length),r(),g(" ",E(5,5,"customer.add-customers-to-group-with-count",P(8,vi,e.selectedCustomerIds.length))," ")}}function Mi(t,s){if(t&1&&(l(0,"span"),p(1),m()),t&2){let e=s.ngIf;r(),g("",e,",")}}function Oi(t,s){if(t&1&&(l(0,"span"),p(1),m()),t&2){let e=s.ngIf;r(),g(" ",e,"")}}function Li(t,s){if(t&1&&_(0,Mi,2,1,"span",3)(1,Oi,2,1,"span",3),t&2){let e,i,n=u();o("ngIf",(e=n.addressForm.get("streetLine1"))==null?null:e.value),r(),o("ngIf",(i=n.addressForm.get("countryCode"))==null?null:i.value)}}function Vi(t,s){if(t&1){let e=T();l(0,"button",4),y("click",function(){h(e);let n=u();return v(n.cancel())}),p(1),a(2,"translate"),m(),l(3,"button",5),y("click",function(){h(e);let n=u();return v(n.save())}),p(4),a(5,"translate"),m()}if(t&2){let e=u();r(),I(d(2,3,"common.cancel")),r(2),o("disabled",!e.addressForm.valid||!e.addressForm.touched),r(),g(" ",d(5,5,"common.update")," ")}}function Ri(t,s){if(t&1&&(l(0,"span",14),p(1),m()),t&2){let e=u().ngIf;r(),g("",e.streetLine1,",")}}function Ui(t,s){t&1&&(l(0,"vdr-chip",15),C(1,"clr-icon",16),p(2),a(3,"translate"),m()),t&2&&(r(2),g(" ",d(3,1,"customer.default-shipping-address")," "))}function Hi(t,s){t&1&&(l(0,"vdr-chip",15),C(1,"clr-icon",17),p(2),a(3,"translate"),m()),t&2&&(r(2),g(" ",d(3,1,"customer.default-billing-address")," "))}function ji(t,s){if(t&1){let e=T();D(0),l(1,"button",18),y("click",function(){h(e);let n=u(2);return v(n.editAddress())}),p(2),a(3,"translate"),m(),l(4,"vdr-dropdown")(5,"button",19),p(6),a(7,"translate"),C(8,"clr-icon",20),m(),l(9,"vdr-dropdown-menu")(10,"button",21),y("click",function(){h(e);let n=u(2);return v(n.setAsDefaultShippingAddress())}),p(11),a(12,"translate"),m(),l(13,"button",21),y("click",function(){h(e);let n=u(2);return v(n.setAsDefaultBillingAddress())}),p(14),a(15,"translate"),m(),C(16,"div",22),l(17,"button",23),y("click",function(){h(e);let n=u(2);return v(n.delete())}),C(18,"clr-icon",24),p(19),a(20,"translate"),m()()(),S()}if(t&2){let e=u(2);r(2),g(" ",d(3,7,"common.edit")," "),r(4),g(" ",d(7,9,"common.more")," "),r(4),o("disabled",e.isDefaultShipping),r(),g(" ",d(12,11,"customer.set-as-default-shipping-address")," "),r(2),o("disabled",e.isDefaultBilling),r(),g(" ",d(15,13,"customer.set-as-default-billing-address")," "),r(5),g(" ",d(20,15,"common.delete")," ")}}function qi(t,s){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"div",3),_(3,Ri,2,1,"span",4),p(4),m(),l(5,"div",5),_(6,Ui,4,3,"vdr-chip",6)(7,Hi,4,3,"vdr-chip",6),m()(),l(8,"div",7)(9,"div",8),C(10,"vdr-formatted-address",9),m()(),l(11,"div",10)(12,"div",11),C(13,"vdr-entity-info",12),_(14,ji,21,17,"ng-container",13),m()()()),t&2){let e=s.ngIf,i=u();r(3),o("ngIf",e.streetLine1),r(),g(" ",e.countryCode," "),r(2),o("ngIf",i.isDefaultShipping),r(),o("ngIf",i.isDefaultBilling),r(3),o("address",e),r(3),o("entity",e),r(),o("ngIf",i.editable)}}function Wi(t,s){t&1&&(p(0),a(1,"translate")),t&2&&g(" ",d(1,1,"customer.add-customer-to-group"),`
`)}function Qi(t,s){if(t&1){let e=T();l(0,"span",5),y("click",function(){let n=h(e),c=n.item,f=n.clear;return v(f(c))}),p(1," \xD7 "),m(),l(2,"vdr-chip",6),p(3),m()}if(t&2){let e=s.item;r(2),o("colorFrom",e.id),r(),I(e.name)}}function zi(t,s){if(t&1&&(l(0,"vdr-chip",6),p(1),m()),t&2){let e=s.item;o("colorFrom",e.id),r(),I(e.name)}}function Yi(t,s){if(t&1){let e=T();l(0,"button",7),y("click",function(){h(e);let n=u();return v(n.cancel())}),p(1),a(2,"translate"),m(),l(3,"button",8),y("click",function(){h(e);let n=u();return v(n.add())}),p(4),a(5,"translate"),m()}if(t&2){let e=u();r(),I(d(2,3,"common.cancel")),r(2),o("disabled",!e.selectedGroupIds.length),r(),g(" ",E(5,5,"customer.add-customer-to-groups-with-count",P(8,vi,e.selectedGroupIds.length))," ")}}var Ki=["portal"],yi=t=>({strategy:t});function Xi(t,s){if(t&1){let e=T();l(0,"vdr-timeline-entry",6)(1,"div",7)(2,"textarea",8),We("ngModelChange",function(n){h(e);let c=u();return qe(c.note,n)||(c.note=n),v(n)}),m(),l(3,"button",9),y("click",function(){h(e);let n=u();return v(n.addNoteToCustomer())}),p(4),a(5,"translate"),m()()()}if(t&2){let e=u();o("featured",!0)("isFirst",!0),r(2),je("ngModel",e.note),r(),o("disabled",!e.note),r(),g(" ",d(5,5,"order.add-note")," ")}}function Ji(t,s){if(t&1){let e=T();l(0,"vdr-customer-history-entry-host",11),y("expandClick",function(){h(e);let n=u(2);return v(n.expanded=!n.expanded)}),m()}if(t&2){let e=u().$implicit,i=u();o("customer",i.customer)("entry",e)("expanded",i.expanded)}}function Zi(t,s){t&1&&(D(0),p(1),a(2,"translate"),S()),t&2&&(r(),g(" ",d(2,1,"customer.history-using-native-auth-strategy")," "))}function en(t,s){if(t&1&&(p(0),a(1,"translate")),t&2){let e=u(3).$implicit;g(" ",E(1,1,"customer.history-using-external-auth-strategy",P(4,yi,e.data.strategy))," ")}}function tn(t,s){if(t&1&&(D(0),l(1,"div",16),p(2),a(3,"translate"),m(),_(4,Zi,3,3,"ng-container",17)(5,en,2,6,"ng-template",null,1,q),S()),t&2){let e=j(6),i=u(2).$implicit;r(2),g(" ",d(3,3,"customer.history-customer-registered")," "),r(2),o("ngIf",i.data.strategy==="native")("ngIfElse",e)}}function nn(t,s){t&1&&(D(0),p(1),a(2,"translate"),S()),t&2&&(r(),g(" ",d(2,1,"customer.history-using-native-auth-strategy")," "))}function rn(t,s){if(t&1&&(p(0),a(1,"translate")),t&2){let e=u(3).$implicit;g(" ",E(1,1,"customer.history-using-external-auth-strategy",P(4,yi,e.data.strategy))," ")}}function on(t,s){if(t&1&&(D(0),l(1,"div",16),p(2),a(3,"translate"),m(),_(4,nn,3,3,"ng-container",17)(5,rn,2,6,"ng-template",null,1,q),S()),t&2){let e=j(6),i=u(2).$implicit;r(2),g(" ",d(3,3,"customer.history-customer-verified")," "),r(2),o("ngIf",i.data.strategy==="native")("ngIfElse",e)}}function an(t,s){if(t&1&&(D(0),l(1,"div",18),p(2),a(3,"translate"),l(4,"vdr-history-entry-detail"),C(5,"vdr-object-tree",19),m()(),S()),t&2){let e=u(2).$implicit;r(2),g(" ",d(3,2,"customer.history-customer-detail-updated")," "),r(3),o("value",e.data.input)}}function sn(t,s){if(t&1&&(D(0),p(1),a(2,"translate"),S()),t&2){let e=u(2).$implicit;r(),g(" ",E(2,1,"customer.history-customer-added-to-group",P(4,Ve,e.data.groupName))," ")}}function ln(t,s){if(t&1&&(D(0),p(1),a(2,"translate"),S()),t&2){let e=u(2).$implicit;r(),g(" ",E(2,1,"customer.history-customer-removed-from-group",P(4,Ve,e.data.groupName))," ")}}function dn(t,s){if(t&1&&(D(0),p(1),a(2,"translate"),l(3,"div",18)(4,"div",20),p(5),m()(),S()),t&2){let e=u(2).$implicit;r(),g(" ",d(2,2,"customer.history-customer-address-created")," "),r(4),I(e.data.address)}}function mn(t,s){if(t&1&&(D(0),p(1),a(2,"translate"),l(3,"div",18)(4,"div",20),p(5),m(),l(6,"vdr-history-entry-detail"),C(7,"vdr-object-tree",19),m()(),S()),t&2){let e=u(2).$implicit;r(),g(" ",d(2,3,"customer.history-customer-address-updated")," "),r(4),I(e.data.address),r(2),o("value",e.data.input)}}function pn(t,s){if(t&1&&(D(0),p(1),a(2,"translate"),l(3,"div",20),p(4),m(),S()),t&2){let e=u(2).$implicit;r(),g(" ",d(2,2,"customer.history-customer-address-deleted")," "),r(3),I(e.data.address)}}function cn(t,s){t&1&&(D(0),p(1),a(2,"translate"),S()),t&2&&(r(),g(" ",d(2,1,"customer.history-customer-password-updated")," "))}function un(t,s){t&1&&(D(0),p(1),a(2,"translate"),S()),t&2&&(r(),g(" ",d(2,1,"customer.history-customer-password-reset-requested")," "))}function _n(t,s){t&1&&(D(0),p(1),a(2,"translate"),S()),t&2&&(r(),g(" ",d(2,1,"customer.history-customer-password-reset-verified")," "))}function gn(t,s){if(t&1&&(D(0),l(1,"div",18),p(2),a(3,"translate"),l(4,"vdr-history-entry-detail")(5,"vdr-labeled-data",21),a(6,"translate"),p(7),m(),l(8,"vdr-labeled-data",21),a(9,"translate"),p(10),m()()(),S()),t&2){let e=u(2).$implicit;r(2),g(" ",d(3,5,"customer.history-customer-email-update-requested")," "),r(3),o("label",d(6,7,"customer.old-email-address")),r(2),g("",e.data.oldEmailAddress," "),r(),o("label",d(9,9,"customer.new-email-address")),r(2),g("",e.data.newEmailAddress," ")}}function Cn(t,s){if(t&1&&(D(0),l(1,"div",18),p(2),a(3,"translate"),l(4,"vdr-history-entry-detail")(5,"vdr-labeled-data",21),a(6,"translate"),p(7),m(),l(8,"vdr-labeled-data",21),a(9,"translate"),p(10),m()()(),S()),t&2){let e=u(2).$implicit;r(2),g(" ",d(3,5,"customer.history-customer-email-update-verified")," "),r(3),o("label",d(6,7,"customer.old-email-address")),r(2),g("",e.data.oldEmailAddress," "),r(),o("label",d(9,9,"customer.new-email-address")),r(2),g("",e.data.newEmailAddress," ")}}function fn(t,s){if(t&1){let e=T();D(0),l(1,"div",18)(2,"div",22),p(3),m(),C(4,"div",23),l(5,"vdr-dropdown")(6,"button",24),C(7,"clr-icon",25),m(),l(8,"vdr-dropdown-menu",26)(9,"button",27),a(10,"hasPermission"),y("click",function(){h(e);let n=u(2).$implicit,c=u();return v(c.updateNote.emit(n))}),C(11,"clr-icon",28),p(12),a(13,"translate"),m(),C(14,"div",29),l(15,"button",27),a(16,"hasPermission"),y("click",function(){h(e);let n=u(2).$implicit,c=u();return v(c.deleteNote.emit(n))}),C(17,"clr-icon",30),p(18),a(19,"translate"),m()()()(),S()}if(t&2){let e=u(2).$implicit;r(3),g(" ",e.data.note," "),r(6),o("disabled",!d(10,5,"UpdateCustomer")),r(3),g(" ",d(13,7,"common.edit")," "),r(3),o("disabled",!d(16,9,"UpdateCustomer")),r(3),g(" ",d(19,11,"common.delete")," ")}}function hn(t,s){if(t&1&&(l(0,"vdr-history-entry-detail"),C(1,"vdr-object-tree",19),m()),t&2){let e=u(3).$implicit;r(),o("value",e.data)}}function vn(t,s){if(t&1&&(D(0),l(1,"div",16),p(2),a(3,"translate"),m(),_(4,hn,2,1,"vdr-history-entry-detail",31),S()),t&2){let e=u(2).$implicit;r(2),g(" ",d(3,2,e.type)," "),r(2),o("ngIf",e.data)}}function yn(t,s){if(t&1&&(l(0,"vdr-timeline-entry",12),D(1,13),_(2,tn,7,5,"ng-container",14)(3,on,7,5,"ng-container",14)(4,an,6,4,"ng-container",14)(5,sn,3,6,"ng-container",14)(6,ln,3,6,"ng-container",14)(7,dn,6,4,"ng-container",14)(8,mn,8,5,"ng-container",14)(9,pn,5,4,"ng-container",14)(10,cn,3,3,"ng-container",14)(11,un,3,3,"ng-container",14)(12,_n,3,3,"ng-container",14)(13,gn,11,11,"ng-container",14)(14,Cn,11,11,"ng-container",14)(15,fn,20,13,"ng-container",14)(16,vn,5,4,"ng-container",15),S(),m()),t&2){let e=u().$implicit,i=u();o("displayType",i.getDisplayType(e))("iconShape",i.getTimelineIcon(e))("createdAt",e.createdAt)("name",i.getName(e))("featured",i.isFeatured(e)),r(),o("ngSwitch",e.type),r(),o("ngSwitchCase",i.type.CUSTOMER_REGISTERED),r(),o("ngSwitchCase",i.type.CUSTOMER_VERIFIED),r(),o("ngSwitchCase",i.type.CUSTOMER_DETAIL_UPDATED),r(),o("ngSwitchCase",i.type.CUSTOMER_ADDED_TO_GROUP),r(),o("ngSwitchCase",i.type.CUSTOMER_REMOVED_FROM_GROUP),r(),o("ngSwitchCase",i.type.CUSTOMER_ADDRESS_CREATED),r(),o("ngSwitchCase",i.type.CUSTOMER_ADDRESS_UPDATED),r(),o("ngSwitchCase",i.type.CUSTOMER_ADDRESS_DELETED),r(),o("ngSwitchCase",i.type.CUSTOMER_PASSWORD_UPDATED),r(),o("ngSwitchCase",i.type.CUSTOMER_PASSWORD_RESET_REQUESTED),r(),o("ngSwitchCase",i.type.CUSTOMER_PASSWORD_RESET_VERIFIED),r(),o("ngSwitchCase",i.type.CUSTOMER_EMAIL_UPDATE_REQUESTED),r(),o("ngSwitchCase",i.type.CUSTOMER_EMAIL_UPDATE_VERIFIED),r(),o("ngSwitchCase",i.type.CUSTOMER_NOTE)}}function bn(t,s){if(t&1&&(D(0),_(1,Ji,1,3,"vdr-customer-history-entry-host",10)(2,yn,17,20,"ng-template",null,0,q),S()),t&2){let e=s.$implicit,i=j(3),n=u();r(),o("ngIf",n.hasCustomComponent(e.type))("ngIfElse",i)}}var xn=()=>["UpdateCustomer"],Dn=t=>["/orders",t];function Sn(t,s){if(t&1){let e=T();l(0,"button",22),y("click",function(){h(e);let n=u();return v(n.create())}),p(1),a(2,"translate"),m()}if(t&2){let e=u();o("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),r(),g(" ",d(2,2,"common.create")," ")}}function In(t,s){if(t&1){let e=T();l(0,"button",22),y("click",function(){h(e);let n=u(2);return v(n.save())}),p(1),a(2,"translate"),m()}if(t&2){let e=u(2);o("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),r(),g(" ",d(2,2,"common.update")," ")}}function Tn(t,s){t&1&&_(0,In,3,4,"button",23),t&2&&o("vdrIfPermissions","UpdateCustomer")}function Fn(t,s){if(t&1&&(l(0,"vdr-labeled-data",26),a(1,"translate"),l(2,"time",27),p(3),a(4,"timeAgo"),m()()),t&2){let e=s.ngIf;o("label",d(1,3,"customer.last-login")),r(2),o("dateTime",e),r(),I(d(4,5,e))}}function En(t,s){if(t&1&&(l(0,"vdr-card"),C(1,"vdr-customer-status-label",24),_(2,Fn,5,7,"vdr-labeled-data",25),m()),t&2){let e=s.ngIf;r(),o("customer",e),r(),o("ngIf",e.user==null?null:e.user.lastLogin)}}function Bn(t,s){if(t&1){let e=T();l(0,"vdr-chip",32),y("iconClick",function(){let n=h(e).$implicit,c=u(3);return v(c.removeFromGroup(n))}),p(1),m()}if(t&2){let e=s.$implicit;o("colorFrom",e.id),r(),I(e.name)}}function Pn(t,s){if(t&1&&(l(0,"div"),_(1,Bn,2,2,"vdr-chip",31),m()),t&2){let e=u().ngIf;r(),o("ngForOf",e)}}function wn(t,s){t&1&&(l(0,"span",33),p(1),a(2,"translate"),m()),t&2&&(r(),g(" ",d(2,1,"customer.not-a-member-of-any-groups")," "))}function An(t,s){if(t&1){let e=T();l(0,"button",34),y("click",function(){h(e);let n=u(2);return v(n.addToGroup())}),C(1,"clr-icon",35),p(2),a(3,"translate"),m()}t&2&&(r(2),g(" ",d(3,1,"customer.add-customer-to-group")," "))}function Gn(t,s){if(t&1&&(l(0,"vdr-card",28),a(1,"translate"),_(2,Pn,2,1,"div",29)(3,wn,3,3,"ng-template",null,1,q),l(5,"div"),_(6,An,4,3,"button",30),m()()),t&2){let e=s.ngIf,i=j(4);o("title",d(1,4,"customer.customer-groups")),r(2),o("ngIf",e.length)("ngIfElse",i),r(4),o("vdrIfPermissions","UpdateCustomerGroup")}}function $n(t,s){if(t&1&&C(0,"vdr-page-entity-info",36),t&2){let e=s.ngIf;o("entity",e)}}function Nn(t,s){t&1&&(l(0,"vdr-form-field",37),a(1,"translate"),C(2,"input",38),m()),t&2&&o("label",d(1,1,"customer.password"))}function kn(t,s){if(t&1&&(l(0,"vdr-card",39),a(1,"translate"),C(2,"vdr-tabbed-custom-fields",40),m()),t&2){let e=u();o("title",d(1,3,"common.custom-fields")),r(2),o("customFields",e.customFields)("customFieldsFormGroup",e.detailForm.get("customer.customFields"))}}function Mn(t,s){if(t&1){let e=T();l(0,"vdr-address-card",55),a(1,"async"),a(2,"hasPermission"),y("setAsDefaultBilling",function(n){h(e);let c=u(2);return v(c.setDefaultBillingAddressId(n))})("setAsDefaultShipping",function(n){h(e);let c=u(2);return v(c.setDefaultShippingAddressId(n))})("deleteAddress",function(n){h(e);let c=u(2);return v(c.toggleDeleteAddress(n))}),m()}if(t&2){let e=s.$implicit,i=u(2);St("to-delete",i.addressesToDeleteIds.has(e.value.id)),o("availableCountries",d(1,8,i.availableCountries$))("isDefaultBilling",i.defaultBillingAddressId===e.value.id)("isDefaultShipping",i.defaultShippingAddressId===e.value.id)("addressForm",e)("customFields",i.addressCustomFields)("editable",d(2,10,ee(12,xn))&&!i.addressesToDeleteIds.has(e.value.id))}}function On(t,s){if(t&1){let e=T();l(0,"button",56),y("click",function(){h(e);let n=u(2);return v(n.addAddress())}),C(1,"clr-icon",35),p(2),a(3,"translate"),m()}t&2&&(r(2),g(" ",d(3,1,"customer.create-new-address")," "))}function Ln(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.id," ")}}function Vn(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.createdAt,"short")," ")}}function Rn(t,s){if(t&1&&(l(0,"a",57)(1,"span"),p(2),m(),C(3,"clr-icon",58),m()),t&2){let e=s.item;o("routerLink",P(2,Dn,e.id)),r(2),I(e.code)}}function Un(t,s){if(t&1&&(l(0,"vdr-chip"),p(1),m()),t&2){let e=s.item;r(),I(e.type)}}function Hn(t,s){if(t&1&&C(0,"vdr-order-state-label",59),t&2){let e=s.item;o("state",e.state)}}function jn(t,s){if(t&1&&(p(0),a(1,"localeCurrency")),t&2){let e=s.item;g(" ",E(1,1,e.totalWithTax,e.currencyCode)," ")}}function qn(t,s){if(t&1&&(p(0),a(1,"timeAgo")),t&2){let e=s.item;g(" ",d(1,1,e.updatedAt)," ")}}function Wn(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.orderPlacedAt,"short")," ")}}function Qn(t,s){if(t&1&&C(0,"vdr-dt2-custom-field-column",60),t&2){let e=s.$implicit;o("customField",e)}}function zn(t,s){if(t&1){let e=T();D(0),l(1,"vdr-card",28),a(2,"translate"),l(3,"div",8),_(4,Mn,3,13,"vdr-address-card",41),m(),_(5,On,4,3,"button",42),m(),l(6,"vdr-card",43),a(7,"translate"),l(8,"vdr-data-table-2",44),a(9,"async"),a(10,"async"),a(11,"translate"),y("itemsPerPageChange",function(n){h(e);let c=u();return v(c.setOrderItemsPerPage(n))})("pageChange",function(n){h(e);let c=u();return v(c.setOrderCurrentPage(n))}),l(12,"vdr-dt2-column",45),a(13,"translate"),_(14,Ln,1,1,"ng-template"),m(),l(15,"vdr-dt2-column",46),a(16,"translate"),_(17,Vn,2,4,"ng-template"),m(),l(18,"vdr-dt2-column",47),a(19,"translate"),_(20,Rn,4,4,"ng-template"),m(),l(21,"vdr-dt2-column",48),a(22,"translate"),_(23,Un,2,1,"ng-template"),m(),l(24,"vdr-dt2-column",49),a(25,"translate"),_(26,Hn,1,1,"ng-template"),m(),l(27,"vdr-dt2-column",50),a(28,"translate"),_(29,jn,2,4,"ng-template"),m(),l(30,"vdr-dt2-column",51),a(31,"translate"),_(32,qn,2,3,"ng-template"),m(),l(33,"vdr-dt2-column",52),a(34,"translate"),_(35,Wn,2,4,"ng-template"),m(),_(36,Qn,1,1,"vdr-dt2-custom-field-column",53),m()(),l(37,"vdr-card",28),a(38,"translate"),l(39,"vdr-customer-history",54),a(40,"async"),a(41,"async"),y("addNote",function(n){h(e);let c=u();return v(c.addNoteToCustomer(n))})("updateNote",function(n){h(e);let c=u();return v(c.updateNote(n))})("deleteNote",function(n){h(e);let c=u();return v(c.deleteNote(n))}),m()(),S()}if(t&2){let e=u();r(),o("title",d(2,26,"customer.addresses")),r(3),o("ngForOf",e.getAddressFormControls()),r(),o("vdrIfPermissions","UpdateCustomer"),r(),o("title",d(7,28,"customer.orders"))("paddingX",!1),r(2),o("items",d(9,30,e.orders$))("itemsPerPage",e.ordersPerPage)("totalItems",d(10,32,e.ordersCount$))("currentPage",e.currentOrdersPage)("emptyStateLabel",d(11,34,"customer.no-orders-placed")),r(4),o("heading",d(13,36,"common.id"))("hiddenByDefault",!0),r(3),o("heading",d(16,38,"common.created-at"))("hiddenByDefault",!0),r(3),o("heading",d(19,40,"common.code"))("optional",!1),r(3),o("heading",d(22,42,"order.order-type"))("hiddenByDefault",!0),r(3),o("heading",d(25,44,"order.state")),r(3),o("heading",d(28,46,"order.total")),r(3),o("heading",d(31,48,"common.updated-at")),r(3),o("heading",d(34,50,"order.placed-at")),r(3),o("ngForOf",e.customFields),r(),o("title",d(38,52,"customer.customer-history")),r(2),o("customer",d(40,54,e.entity$))("history",d(41,56,e.history$))}}function Yn(t,s){if(t&1){let e=T();l(0,"button",10),y("click",function(){h(e);let n=u();return v(n.create())}),p(1),a(2,"translate"),m()}if(t&2){let e=u();o("disabled",!(e.detailForm.valid&&e.detailForm.dirty)),r(),g(" ",d(2,2,"common.create")," ")}}function Kn(t,s){if(t&1){let e=T();l(0,"button",10),y("click",function(){h(e);let n=u(2);return v(n.save())}),p(1),a(2,"translate"),m()}if(t&2){let e=u(2);o("disabled",!(e.detailForm.valid&&e.detailForm.dirty)),r(),g(" ",d(2,2,"common.update")," ")}}function Xn(t,s){t&1&&_(0,Kn,3,4,"button",11),t&2&&o("vdrIfPermissions","UpdateCustomer")}function Jn(t,s){if(t&1&&(l(0,"vdr-card"),C(1,"vdr-page-entity-info",12),m()),t&2){let e=s.ngIf;r(),o("entity",e)}}function Zn(t,s){if(t&1&&(l(0,"vdr-card",13),a(1,"translate"),C(2,"vdr-tabbed-custom-fields",14),m()),t&2){let e=u();o("title",d(1,3,"common.custom-fields")),r(2),o("customFields",e.customFields)("customFieldsFormGroup",e.detailForm.get("customFields"))}}var er=()=>["CreateCustomerGroup","UpdateCustomerGroup"];function tr(t,s){t&1&&(l(0,"span"),p(1),a(2,"translate"),m()),t&2&&(r(),I(d(2,1,"customer.update-customer-group")))}function ir(t,s){t&1&&(l(0,"span"),p(1),a(2,"translate"),m()),t&2&&(r(),I(d(2,1,"customer.create-customer-group")))}function nr(t,s){if(t&1&&_(0,tr,3,3,"span",6)(1,ir,3,3,"span",6),t&2){let e=u();o("ngIf",e.group.id),r(),o("ngIf",!e.group.id)}}function rr(t,s){if(t&1&&(l(0,"section",7)(1,"label"),p(2),a(3,"translate"),m(),C(4,"vdr-tabbed-custom-fields",8),m()),t&2){let e=u();r(2),I(d(3,3,"common.custom-fields")),r(2),o("customFields",e.customFields)("customFieldsFormGroup",e.form.get("customFields"))}}function or(t,s){t&1&&(l(0,"span"),p(1),a(2,"translate"),m()),t&2&&(r(),I(d(2,1,"customer.update-customer-group")))}function ar(t,s){t&1&&(l(0,"span"),p(1),a(2,"translate"),m()),t&2&&(r(),I(d(2,1,"customer.create-customer-group")))}function sr(t,s){if(t&1){let e=T();l(0,"button",9),y("click",function(){h(e);let n=u();return v(n.cancel())}),p(1),a(2,"translate"),m(),l(3,"button",10),y("click",function(){h(e);let n=u();return v(n.save())}),_(4,or,3,3,"span",6)(5,ar,3,3,"span",6),m()}if(t&2){let e=u();r(),I(d(2,4,"common.cancel")),r(2),o("disabled",!e.form.valid),r(),o("ngIf",e.group.id),r(),o("ngIf",!e.group.id)}}var lr=()=>["./","create"],ft=t=>["./",t],dr=t=>({contents:t});function mr(t,s){t&1&&(l(0,"a",5),C(1,"clr-icon",6),p(2),a(3,"translate"),m()),t&2&&(o("routerLink",ee(4,lr)),r(2),g(" ",d(3,2,"customer.create-new-customer-group")," "))}function pr(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.id," ")}}function cr(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.createdAt,"short")," ")}}function ur(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.updatedAt,"short")," ")}}function _r(t,s){if(t&1&&(l(0,"a",16)(1,"span"),p(2),m(),C(3,"clr-icon",17),m()),t&2){let e=s.item;o("routerLink",P(2,ft,e.id)),r(2),I(e.name)}}function gr(t,s){if(t&1&&C(0,"vdr-dt2-custom-field-column",18),t&2){let e=s.$implicit,i=u(2);o("customField",e)("sorts",i.sorts)}}function Cr(t,s){if(t&1&&(l(0,"a",19)(1,"span"),p(2),a(3,"translate"),m(),C(4,"clr-icon",20),m()),t&2){let e=s.item;o("routerLink",P(6,ft,P(4,dr,e.id))),r(2),I(d(3,2,"customer.view-group-members"))}}function fr(t,s){if(t&1){let e=T();l(0,"vdr-data-table-2",7),a(1,"async"),a(2,"async"),a(3,"async"),a(4,"async"),a(5,"async"),y("pageChange",function(n){h(e);let c=u();return v(c.setPageNumber(n))})("itemsPerPageChange",function(n){h(e);let c=u();return v(c.setItemsPerPage(n))})("visibleColumnsChange",function(n){h(e);let c=u();return v(c.setVisibleColumns(n))}),C(6,"vdr-bulk-action-menu",8)(7,"vdr-dt2-search",9),a(8,"translate"),l(9,"vdr-dt2-column",10),a(10,"translate"),_(11,pr,1,1,"ng-template"),m(),l(12,"vdr-dt2-column",11),a(13,"translate"),_(14,cr,2,4,"ng-template"),m(),l(15,"vdr-dt2-column",12),a(16,"translate"),_(17,ur,2,4,"ng-template"),m(),l(18,"vdr-dt2-column",13),a(19,"translate"),_(20,_r,4,4,"ng-template"),m(),_(21,gr,1,2,"vdr-dt2-custom-field-column",14),l(22,"vdr-dt2-column",15),a(23,"translate"),_(24,Cr,5,8,"ng-template"),m()()}if(t&2){let e=u();o("id",e.dataTableListId)("items",d(1,25,e.items$))("itemsPerPage",d(2,27,e.itemsPerPage$))("totalItems",d(3,29,e.totalItems$))("currentPage",d(4,31,e.currentPage$))("filters",e.filters)("activeIndex",d(5,33,e.activeIndex$)),r(6),o("hostComponent",e)("selectionManager",e.selectionManager),r(),o("searchTermControl",e.searchTermControl)("searchTermPlaceholder",d(8,35,"common.search-by-name")),r(2),o("heading",d(10,37,"common.id"))("hiddenByDefault",!0),r(3),o("heading",d(13,39,"common.created-at"))("hiddenByDefault",!0)("sort",e.sorts.get("createdAt")),r(3),o("heading",d(16,41,"common.updated-at"))("hiddenByDefault",!0)("sort",e.sorts.get("updatedAt")),r(3),o("heading",d(19,43,"common.name"))("optional",!1)("sort",e.sorts.get("name")),r(3),o("ngForOf",e.customFields),r(),o("heading",d(23,45,"common.view-contents"))("optional",!1)}}function hr(t,s){if(t&1){let e=T();D(0),l(1,"button",22),y("click",function(){let n=h(e).ngIf,c=u(2);return v(c.addToGroup(n))}),C(2,"clr-icon",6),l(3,"span"),p(4),a(5,"translate"),m()(),l(6,"vdr-customer-group-member-list",23),a(7,"async"),a(8,"async"),a(9,"async"),y("fetchParamsChange",function(n){h(e);let c=u(2);return v(c.fetchGroupMembers$.next(n))}),m(),S()}if(t&2){let e=s.ngIf,i=u(2);r(4),I(E(5,5,"customer.add-customers-to-group",P(14,Ve,e.name))),r(2),o("members",d(7,8,i.members$))("route",i.route)("totalItems",d(8,10,i.membersTotal$))("activeGroup",d(9,12,i.activeGroup$))}}function vr(t,s){if(t&1&&(_(0,hr,10,16,"ng-container",21),a(1,"async")),t&2){let e=u();o("ngIf",d(1,1,e.activeGroup$))}}var yr=()=>["./create"];function br(t,s){t&1&&(l(0,"a",12),C(1,"clr-icon",13),p(2),a(3,"translate"),m()),t&2&&(o("routerLink",ee(4,yr)),r(2),g(" ",d(3,2,"customer.create-new-customer")," "))}function xr(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.id," ")}}function Dr(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.createdAt,"short")," ")}}function Sr(t,s){if(t&1&&(p(0),a(1,"localeDate")),t&2){let e=s.item;g(" ",E(1,1,e.updatedAt,"short")," ")}}function Ir(t,s){if(t&1&&(l(0,"a",14)(1,"span"),p(2),m(),C(3,"clr-icon",15),m()),t&2){let e=s.item;o("routerLink",P(4,ft,e.id)),r(2),He(" ",e.title," ",e.firstName," ",e.lastName," ")}}function Tr(t,s){if(t&1&&C(0,"vdr-customer-status-label",16),t&2){let e=s.item;o("customer",e)}}function Fr(t,s){if(t&1&&p(0),t&2){let e=s.item;g(" ",e.emailAddress," ")}}function Er(t,s){if(t&1&&C(0,"vdr-dt2-custom-field-column",17),t&2){let e=s.$implicit,i=u();o("customField",e)("sorts",i.sorts)}}var ht=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-status-label"]],inputs:{customer:"customer"},standalone:!1,decls:2,vars:2,consts:[[4,"ngIf"],["shape","check-circle",1,"verified-user-icon"],["shape","check-circle",1,"registered-user-icon"]],template:function(i,n){i&1&&_(0,Ti,3,2,"vdr-chip",0)(1,Fi,3,3,"vdr-chip",0),i&2&&(o("ngIf",n.customer.user==null?null:n.customer.user.id),r(),o("ngIf",!(n.customer.user!=null&&n.customer.user.id)))},dependencies:[U,O,ue,$],styles:[".registered-user-icon[_ngcontent-%COMP%]{color:var(--color-grey-300)}.verified-user-icon[_ngcontent-%COMP%]{color:var(--color-success-500)}"],changeDetection:0})}}return t})(),bi=(()=>{class t{constructor(e,i){this.router=e,this.dataService=i,this.selectedMemberIds=[],this.selectionChange=new k,this.fetchParamsChange=new k,this.filterTermControl=new jt(""),this.selectionManager=new ni({multiSelect:!0,itemsAreEqual:(n,c)=>n.id===c.id,additiveMode:!0}),this.refresh$=new Y(!0),this.destroy$=new Se}ngOnInit(){this.membersCurrentPage$=this.route.paramMap.pipe(F(i=>i.get("membersPage")),F(i=>i?+i:1),ne(1),Ie()),this.membersItemsPerPage$=this.route.paramMap.pipe(F(i=>i.get("membersPerPage")),F(i=>i?+i:10),ne(10),Ie());let e=this.filterTermControl.valueChanges.pipe($t(250),Lt(()=>this.setContentsPageNumber(1)),ne(""));ie(this.membersCurrentPage$,this.membersItemsPerPage$,e,this.refresh$).pipe(Ye(this.destroy$)).subscribe(([i,n,c])=>{let f=n,b=(i-1)*n;this.fetchParamsChange.emit({filterTerm:c??"",skip:b,take:f})}),this.selectionManager.setCurrentItems(this.members?.filter(i=>this.selectedMemberIds.includes(i.id))??[]),this.selectionManager.selectionChanges$.pipe(Ye(this.destroy$)).subscribe(i=>{this.selectionChange.emit(i.map(n=>n.id))})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setContentsPageNumber(e){this.setParam("membersPage",e)}setContentsItemsPerPage(e){this.setParam("membersPerPage",e)}refresh(){this.refresh$.next(!0)}setParam(e,i){this.router.navigate(["./",Q(N({},this.route.snapshot.params),{[e]:i})],{relativeTo:this.route,queryParamsHandling:"merge"})}static{this.\u0275fac=function(i){return new(i||t)(x(Ke),x(L))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-group-member-list"]],inputs:{locationId:"locationId",members:"members",totalItems:"totalItems",route:"route",selectedMemberIds:"selectedMemberIds",activeGroup:"activeGroup"},outputs:{selectionChange:"selectionChange",fetchParamsChange:"fetchParamsChange"},standalone:!1,decls:24,vars:39,consts:[[3,"pageChange","itemsPerPageChange","id","items","itemsPerPage","totalItems","currentPage"],[3,"locationId","hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","updated-at",3,"heading","hiddenByDefault"],["id","name",3,"heading","optional"],["id","status",3,"heading","hiddenByDefault"],["id","email-address",3,"heading"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customer"]],template:function(i,n){i&1&&(l(0,"vdr-data-table-2",0),a(1,"async"),a(2,"async"),y("pageChange",function(f){return n.setContentsPageNumber(f)})("itemsPerPageChange",function(f){return n.setContentsItemsPerPage(f)}),C(3,"vdr-bulk-action-menu",1)(4,"vdr-dt2-search",2),a(5,"translate"),l(6,"vdr-dt2-column",3),a(7,"translate"),_(8,Bi,1,1,"ng-template"),m(),l(9,"vdr-dt2-column",4),a(10,"translate"),_(11,Pi,2,4,"ng-template"),m(),l(12,"vdr-dt2-column",5),a(13,"translate"),_(14,wi,2,4,"ng-template"),m(),l(15,"vdr-dt2-column",6),a(16,"translate"),_(17,Ai,4,6,"ng-template"),m(),l(18,"vdr-dt2-column",7),a(19,"translate"),_(20,Gi,1,1,"ng-template"),m(),l(21,"vdr-dt2-column",8),a(22,"translate"),_(23,$i,1,1,"ng-template"),m()()),i&2&&(o("id",n.locationId)("items",n.members)("itemsPerPage",d(1,21,n.membersItemsPerPage$))("totalItems",n.totalItems)("currentPage",d(2,23,n.membersCurrentPage$)),r(3),o("locationId",n.locationId)("hostComponent",n)("selectionManager",n.selectionManager),r(),o("searchTermControl",n.filterTermControl)("searchTermPlaceholder",d(5,25,"customer.search-customers-by-email")),r(2),o("heading",d(7,27,"common.id"))("hiddenByDefault",!0),r(3),o("heading",d(10,29,"common.created-at"))("hiddenByDefault",!0),r(3),o("heading",d(13,31,"common.updated-at"))("hiddenByDefault",!0),r(3),o("heading",d(16,33,"customer.name"))("optional",!1),r(3),o("heading",d(19,35,"common.status"))("hiddenByDefault",!0),r(3),o("heading",d(22,37,"customer.email-address")))},dependencies:[U,oe,Ne,ve,he,Me,ht,V,$,ce],encapsulation:2,changeDetection:0})}}return t})(),Br=(()=>{class t{constructor(e){this.dataService=e,this.selectedCustomerIds=[],this.fetchGroupMembers$=new Y({skip:0,take:10,filterTerm:""})}ngOnInit(){let e=this.fetchGroupMembers$.pipe(M(({skip:i,take:n,filterTerm:c})=>this.dataService.customer.getCustomerList(n,i,c).mapStream(f=>f.customers)));this.customers$=e.pipe(F(i=>i.items)),this.customersTotal$=e.pipe(F(i=>i.totalItems))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedCustomerIds)}static{this.\u0275fac=function(i){return new(i||t)(x(L))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-add-customer-to-group-dialog"]],standalone:!1,decls:5,vars:8,consts:[["vdrDialogTitle",""],["locationId","customer-group-members-picker-list",3,"fetchParamsChange","selectionChange","members","totalItems","route","selectedMemberIds"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&(_(0,Ni,2,6,"ng-template",0),l(1,"vdr-customer-group-member-list",1),a(2,"async"),a(3,"async"),y("fetchParamsChange",function(f){return n.fetchGroupMembers$.next(f)})("selectionChange",function(f){return n.selectedCustomerIds=f}),m(),_(4,ki,6,10,"ng-template",2)),i&2&&(r(),o("members",d(2,4,n.customers$))("totalItems",d(3,6,n.customersTotal$))("route",n.route)("selectedMemberIds",n.selectedCustomerIds))},dependencies:[de,me,bi,V,$],encapsulation:2,changeDetection:0})}}return t})(),Pr=(()=>{class t{constructor(e){this.changeDetector=e,this.availableCountries=[]}ngOnInit(){this.addressForm.valueChanges.subscribe(()=>this.changeDetector.markForCheck())}cancel(){this.resolveWith()}save(){this.resolveWith(this.addressForm)}static{this.\u0275fac=function(i){return new(i||t)(x(De))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-address-detail-dialog"]],standalone:!1,decls:3,vars:3,consts:[["vdrDialogTitle",""],[3,"formGroup","availableCountries","customFields"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&(_(0,Li,2,2,"ng-template",0),C(1,"vdr-address-form",1),_(2,Vi,6,7,"ng-template",2)),i&2&&(r(),o("formGroup",n.addressForm)("availableCountries",n.availableCountries)("customFields",n.customFields))},dependencies:[O,se,le,de,me,ai,$],styles:["clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0})}}return t})(),wr=(()=>{class t{constructor(e,i){this.modalService=e,this.changeDetector=i,this.availableCountries=[],this.editable=!0,this.setAsDefaultShipping=new k,this.setAsDefaultBilling=new k,this.deleteAddress=new k,this.dataDependenciesPopulated=new Y(!1)}ngOnInit(){this.addressForm.get("streetLine1").value||this.dataDependenciesPopulated.pipe(ze(i=>i),Qe(1)).subscribe(()=>{this.editAddress()})}ngOnChanges(e){this.customFields!=null&&this.availableCountries!=null&&this.dataDependenciesPopulated.next(!0)}getCountryName(e){if(!this.availableCountries)return"";let i=this.availableCountries.find(n=>n.code===e);return i?i.name:""}setAsDefaultBillingAddress(){this.setAsDefaultBilling.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}setAsDefaultShippingAddress(){this.setAsDefaultShipping.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}delete(){this.deleteAddress.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}editAddress(){this.modalService.fromComponent(Pr,{locals:{addressForm:this.addressForm,customFields:this.customFields,availableCountries:this.availableCountries},size:"md",closable:!0}).subscribe(()=>{this.changeDetector.markForCheck()})}static{this.\u0275fac=function(i){return new(i||t)(x(W),x(De))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-address-card"]],inputs:{addressForm:"addressForm",customFields:"customFields",availableCountries:"availableCountries",isDefaultBilling:"isDefaultBilling",isDefaultShipping:"isDefaultShipping",editable:"editable"},outputs:{setAsDefaultShipping:"setAsDefaultShipping",setAsDefaultBilling:"setAsDefaultBilling",deleteAddress:"deleteAddress"},standalone:!1,features:[bt],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"address-title"],["class","street-line",4,"ngIf"],[1,"default-controls"],["class","is-default p8",4,"ngIf"],[1,"card-block"],[1,"card-text"],[3,"address"],[1,"card-footer"],[1,"address-actions"],[3,"entity"],[4,"ngIf"],[1,"street-line"],[1,"is-default","p8"],["shape","truck"],["shape","credit-card"],[1,"button-small",3,"click"],["type","button","vdrDropdownTrigger","",1,"button-small"],["shape","ellipsis-vertical","size","12"],["vdrDropdownItem","",3,"click","disabled"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"click"],["shape","trash",1,"is-danger"]],template:function(i,n){i&1&&_(0,qi,15,7,"div",0),i&2&&o("ngIf",n.addressForm.value)},dependencies:[U,O,ue,tt,it,nt,rt,di,ri,$],styles:["[_nghost-%COMP%]{display:block;max-width:360px}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}.defaul-controls[_ngcontent-%COMP%]{display:flex}.is-default[_ngcontent-%COMP%]{margin:0;color:var(--color-success-500)}.address-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-unit)}.address-actions[_ngcontent-%COMP%]   vdr-entity-info[_ngcontent-%COMP%]{margin-top:1px}"],changeDetection:0})}}return t})(),Ar=(()=>{class t{constructor(e){this.dataService=e,this.selectedGroupIds=[]}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items)}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedGroupIds)}static{this.\u0275fac=function(i){return new(i||t)(x(L))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-select-customer-group-dialog"]],standalone:!1,decls:6,vars:8,consts:[["vdrDialogTitle",""],["appendTo","body","bindValue","id",3,"ngModelChange","items","addTag","multiple","ngModel","clearable","searchable"],["ng-label-tmp",""],["ng-option-tmp",""],["vdrDialogButtons",""],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[3,"colorFrom"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&(_(0,Wi,2,3,"ng-template",0),l(1,"ng-select",1),a(2,"async"),We("ngModelChange",function(f){return qe(n.selectedGroupIds,f)||(n.selectedGroupIds=f),f}),_(3,Qi,4,2,"ng-template",2)(4,zi,2,2,"ng-template",3),m(),_(5,Yi,6,10,"ng-template",4)),i&2&&(r(),o("items",d(2,6,n.groups$))("addTag",!1)("multiple",!0),je("ngModel",n.selectedGroupIds),o("clearable",!0)("searchable",!1))},dependencies:[K,Xe,Yt,Qt,zt,ue,de,me,V,$],encapsulation:2,changeDetection:0})}}return t})(),Gr=(()=>{class t{constructor(e){this.historyEntryComponentService=e,this.expandClick=new k}ngOnInit(){let e=this.historyEntryComponentService.getComponent(this.entry.type),i=this.portalRef.createComponent(e);i.instance.entry=this.entry,i.instance.customer=this.customer,this.instance=i.instance,this.componentRef=i}ngOnDestroy(){this.componentRef?.destroy()}static{this.\u0275fac=function(i){return new(i||t)(x(Ct))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-history-entry-host"]],viewQuery:function(i,n){if(i&1&&It(Ki,7,xt),i&2){let c;Tt(c=Ft())&&(n.portalRef=c.first)}},inputs:{entry:"entry",customer:"customer",expanded:"expanded"},outputs:{expandClick:"expandClick"},exportAs:["historyEntry"],standalone:!1,decls:3,vars:6,consts:[["portal",""],[3,"expandClick","displayType","iconShape","createdAt","name","featured","collapsed"]],template:function(i,n){if(i&1){let c=T();l(0,"vdr-timeline-entry",1),y("expandClick",function(){return h(c),v(n.expandClick.emit())}),C(1,"div",null,0),m()}i&2&&o("displayType",n.instance.getDisplayType(n.entry))("iconShape",n.instance.getIconShape&&n.instance.getIconShape(n.entry))("createdAt",n.entry.createdAt)("name",n.instance.getName&&n.instance.getName(n.entry))("featured",n.instance.isFeatured(n.entry))("collapsed",!n.expanded&&!n.instance.isFeatured(n.entry))},dependencies:[pt],encapsulation:2})}}return t})(),$r=(()=>{class t{constructor(e){this.historyEntryComponentService=e,this.addNote=new k,this.updateNote=new k,this.deleteNote=new k,this.note="",this.expanded=!1,this.type=A}hasCustomComponent(e){return!!this.historyEntryComponentService.getComponent(e)}getDisplayType(e){switch(e.type){case A.CUSTOMER_VERIFIED:case A.CUSTOMER_EMAIL_UPDATE_VERIFIED:case A.CUSTOMER_PASSWORD_RESET_VERIFIED:return"success";case A.CUSTOMER_REGISTERED:return"muted";case A.CUSTOMER_REMOVED_FROM_GROUP:return"error";default:return"default"}}getTimelineIcon(e){switch(e.type){case A.CUSTOMER_REGISTERED:return"user";case A.CUSTOMER_VERIFIED:return["assign-user","is-solid"];case A.CUSTOMER_NOTE:return"note";case A.CUSTOMER_ADDED_TO_GROUP:case A.CUSTOMER_REMOVED_FROM_GROUP:return"users"}}isFeatured(e){switch(e.type){case A.CUSTOMER_REGISTERED:case A.CUSTOMER_VERIFIED:return!0;default:return!1}}getName(e){let{administrator:i}=e;return i?`${i.firstName} ${i.lastName}`:`${this.customer.firstName} ${this.customer.lastName}`}addNoteToCustomer(){this.addNote.emit({note:this.note}),this.note=""}static{this.\u0275fac=function(i){return new(i||t)(x(Ct))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-history"]],inputs:{customer:"customer",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},standalone:!1,decls:4,vars:3,consts:[["defaultComponents",""],["namedStrategy",""],[1,"entry-list"],["iconShape","note","displayType","muted",3,"featured","isFirst",4,"vdrIfPermissions"],[4,"ngFor","ngForOf"],[3,"isLast"],["iconShape","note","displayType","muted",3,"featured","isFirst"],[1,"note-entry"],["name","note",1,"note",3,"ngModelChange","ngModel"],[1,"btn","btn-secondary",3,"click","disabled"],[3,"customer","entry","expanded","expandClick",4,"ngIf","ngIfElse"],[3,"expandClick","customer","entry","expanded"],[3,"displayType","iconShape","createdAt","name","featured"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"title"],[4,"ngIf","ngIfElse"],[1,"flex"],[3,"value"],[1,"address-string"],[3,"label"],[1,"note-text"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"button-small","ml-1"],["shape","ellipsis-vertical","size","12"],["vdrPosition","bottom-right"],["vdrDropdownItem","",3,"click","disabled"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"],[4,"ngIf"]],template:function(i,n){i&1&&(l(0,"div",2),_(1,Xi,6,7,"vdr-timeline-entry",3)(2,bn,4,2,"ng-container",4),C(3,"vdr-timeline-entry",5),m()),i&2&&(r(),o("vdrIfPermissions","UpdateCustomer"),r(),o("ngForOf",n.history),r(),o("isLast",!0))},dependencies:[U,te,O,Et,Bt,Pt,ae,K,Xe,pe,tt,it,nt,rt,ot,oi,J,pt,mi,Gr,$,$e],styles:[".entry-list[_ngcontent-%COMP%]{margin:24px 12px 24px 24px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-inline-end:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-text-100);white-space:pre-wrap}.address-string[_ngcontent-%COMP%]{font-size:smaller;color:var(--color-text-200)}"],changeDetection:0})}}return t})(),po=re`
    query CustomerDetailQuery($id: ID!, $orderListOptions: OrderListOptions) {
        customer(id: $id) {
            ...Customer
            groups {
                id
                name
            }
            orders(options: $orderListOptions) {
                items {
                    id
                    code
                    type
                    state
                    total
                    totalWithTax
                    currencyCode
                    createdAt
                    updatedAt
                    orderPlacedAt
                }
                totalItems
            }
        }
    }
    ${Zt}
`,Nr=(()=>{class t extends ct{constructor(e,i,n,c,f){super(),this.changeDetector=e,this.formBuilder=i,this.dataService=n,this.modalService=c,this.notificationService=f,this.customFields=this.getCustomFieldConfig("Customer"),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.detailForm=this.formBuilder.group({customer:this.formBuilder.group({title:"",firstName:["",R.required],lastName:["",R.required],phoneNumber:"",emailAddress:["",[R.required,R.email]],password:"",customFields:this.formBuilder.group(Le(this.customFields))}),addresses:new Je([])}),this.fetchHistory=new Se,this.addressesToDeleteIds=new Set,this.addressDefaultsUpdated=!1,this.ordersPerPage=10,this.currentOrdersPage=1,this.orderListUpdates$=new Se}ngOnInit(){this.init(),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(i=>i.countries.items).pipe(Ot(1));let e=this.entity$.pipe(Mt(this.orderListUpdates$));this.orders$=e.pipe(F(i=>i.orders.items)),this.ordersCount$=this.entity$.pipe(F(i=>i.orders.totalItems)),this.history$=this.fetchHistory.pipe(ne(null),M(()=>this.dataService.customer.getCustomerHistory(this.id,{sort:{createdAt:Pe.DESC}}).mapStream(i=>i.customer?.history.items)))}ngOnDestroy(){this.destroy(),this.orderListUpdates$.complete()}getAddressFormControls(){return this.detailForm.get(["addresses"]).controls}setDefaultBillingAddressId(e){this.defaultBillingAddressId=e,this.addressDefaultsUpdated=!0}setDefaultShippingAddressId(e){this.defaultShippingAddressId=e,this.addressDefaultsUpdated=!0}toggleDeleteAddress(e){this.addressesToDeleteIds.has(e)?this.addressesToDeleteIds.delete(e):this.addressesToDeleteIds.add(e)}addAddress(){let e=this.detailForm.get("addresses"),i=this.formBuilder.group({fullName:"",company:"",streetLine1:["",R.required],streetLine2:"",city:"",province:"",postalCode:"",countryCode:["",R.required],phoneNumber:"",defaultShippingAddress:!1,defaultBillingAddress:!1,customFields:this.formBuilder.group(this.addressCustomFields.reduce((n,c)=>Q(N({},n),{[c.name]:""}),{}))});e.push(i)}setOrderItemsPerPage(e){this.ordersPerPage=+e,this.fetchOrdersList()}setOrderCurrentPage(e){this.currentOrdersPage=+e,this.fetchOrdersList()}create(){let e=this.detailForm.get("customer");if(!e)return;let{title:i,emailAddress:n,firstName:c,lastName:f,phoneNumber:b,password:B}=e.value,G=e.get("customFields")?.value;if(!n||!c||!f)return;let Re={title:i,emailAddress:n,firstName:c,lastName:f,phoneNumber:b,customFields:G};this.dataService.customer.createCustomer(Re,B).subscribe(({createCustomer:H})=>{switch(H.__typename){case"Customer":this.notificationService.success("common.notify-create-success",{entity:"Customer"}),H.emailAddress&&!B&&this.notificationService.notify({message:"customer.email-verification-sent",translationVars:{emailAddress:n},type:"info",duration:1e4}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.router.navigate(["../",H.id],{relativeTo:this.route});break;case"EmailAddressConflictError":this.notificationService.error(H.message)}})}save(){this.entity$.pipe(Qe(1),At(({id:e})=>{let i=[],n=this.detailForm.get("customer");if(n&&n.dirty){let f=n.value,b=n.get("customFields")?.value,B={id:e,title:f.title,emailAddress:f.emailAddress,firstName:f.firstName,lastName:f.lastName,phoneNumber:f.phoneNumber,customFields:b};i.push(this.dataService.customer.updateCustomer(B).pipe(F(G=>G.updateCustomer)))}let c=this.detailForm.get("addresses");if(c&&c.dirty||this.addressDefaultsUpdated){for(let f of c.controls)if(f.dirty||this.addressDefaultsUpdated){let b=f.value,B={fullName:b.fullName,company:b.company,streetLine1:b.streetLine1,streetLine2:b.streetLine2,city:b.city,province:b.province,postalCode:b.postalCode,countryCode:b.countryCode,phoneNumber:b.phoneNumber,defaultShippingAddress:this.defaultShippingAddressId===b.id,defaultBillingAddress:this.defaultBillingAddressId===b.id,customFields:b.customFields};b.id?this.addressesToDeleteIds.has(b.id)?i.push(this.dataService.customer.deleteCustomerAddress(b.id).pipe(F(G=>G.deleteCustomerAddress))):i.push(this.dataService.customer.updateCustomerAddress(Q(N({},B),{id:b.id})).pipe(F(G=>G.updateCustomerAddress))):i.push(this.dataService.customer.createCustomerAddress(e,B).pipe(F(G=>G.createCustomerAddress)))}}return Vt(i)})).subscribe(e=>{let i=!1;for(let n of e)switch(n.__typename){case"Customer":case"Address":case"Success":i||(this.notificationService.success("common.notify-update-success",{entity:"Customer"}),i=!0,this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.fetchHistory.next(),this.refreshCustomer().subscribe());break;case"EmailAddressConflictError":this.notificationService.error(n.message);break}},e=>{this.notificationService.error("common.notify-update-error",{entity:"Customer"})})}addToGroup(){this.modalService.fromComponent(Ar,{size:"md"}).pipe(M(e=>e?wt(e):z),Gt(e=>this.dataService.customer.addCustomersToGroup(e,[this.id]))).subscribe({next:e=>{this.notificationService.success("customer.add-customers-to-group-success",{customerCount:1,groupName:e.addCustomersToGroup.name})},complete:()=>{this.refreshCustomer().subscribe(),this.fetchHistory.next()}})}removeFromGroup(e){this.modalService.dialog({title:"customer.confirm-remove-customer-from-group",buttons:[{type:"secondary",label:"common.cancel"},{type:"danger",label:"common.delete",returnValue:!0}]}).pipe(M(i=>i?this.dataService.customer.removeCustomersFromGroup(e.id,[this.id]):z),M(()=>this.refreshCustomer())).subscribe(i=>{this.notificationService.success("customer.remove-customers-from-group-success",{customerCount:1,groupName:e.name}),this.fetchHistory.next()})}addNoteToCustomer({note:e}){this.dataService.customer.addNoteToCustomer(this.id,e).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success("common.notify-create-success",{entity:"Note"})})}updateNote(e){this.modalService.fromComponent(li,{closable:!0,locals:{displayPrivacyControls:!1,note:e.data.note}}).pipe(M(i=>i?this.dataService.customer.updateCustomerNote({noteId:e.id,note:i.note}):z)).subscribe(i=>{this.fetchHistory.next(),this.notificationService.success("common.notify-update-success",{entity:"Note"})})}deleteNote(e){return this.modalService.dialog({title:"common.confirm-delete-note",body:e.data.note,buttons:[{type:"secondary",label:"common.cancel"},{type:"danger",label:"common.delete",returnValue:!0}]}).pipe(M(i=>i?this.dataService.customer.deleteCustomerNote(e.id):z)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success("common.notify-delete-success",{entity:"Note"})})}setFormValues(e){let i=this.detailForm.get("customer");if(i&&i.patchValue({title:e.title??null,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber??null,emailAddress:e.emailAddress,password:"",customFields:{}}),e.addresses){let c=new Je([]);for(let f of e.addresses){let n=f,{customFields:b}=n,B=vt(n,["customFields"]),G=this.formBuilder.group(Q(N({},B),{countryCode:f.country.code,customFields:this.formBuilder.group(this.addressCustomFields.reduce((Re,H)=>Q(N({},Re),{[H.name]:f.customFields[H.name]}),{}))}));c.push(G),f.defaultShippingAddress&&(this.defaultShippingAddressId=f.id),f.defaultBillingAddress&&(this.defaultBillingAddressId=f.id)}this.detailForm.setControl("addresses",c)}this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customer","customFields"]),e),this.changeDetector.markForCheck()}fetchOrdersList(){this.dataService.query(we,{id:this.id,orderListOptions:{take:this.ordersPerPage,skip:(this.currentOrdersPage-1)*this.ordersPerPage,sort:{orderPlacedAt:Pe.DESC}}}).single$.pipe(F(e=>e.customer),ze(hi.notNullOrUndefined)).subscribe(e=>this.orderListUpdates$.next(e))}refreshCustomer(){return this.dataService.query(we,{id:this.id,orderListOptions:{take:0}}).single$}static{this.\u0275fac=function(i){return new(i||t)(x(De),x(Ze),x(L),x(W),x(X))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-detail"]],standalone:!1,features:[Z],decls:50,vars:53,consts:[["updateButton",""],["noGroups",""],["locationId","customer-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],[4,"ngIf"],[3,"title",4,"ngIf"],[3,"entity",4,"ngIf"],[1,"form",3,"formGroup"],[1,"form-grid"],["for","title",3,"label","readOnlyToggle"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label","readOnlyToggle"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label","readOnlyToggle"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label","readOnlyToggle"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label","readOnlyToggle"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["for","password",3,"label",4,"ngIf"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","customer-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"click","disabled"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"customer"],["class","last-login",3,"label",4,"ngIf"],[1,"last-login",3,"label"],[3,"dateTime"],[3,"title"],[4,"ngIf","ngIfElse"],["class","button-small mt-1",3,"click",4,"vdrIfPermissions"],["icon","times",3,"colorFrom","iconClick",4,"ngFor","ngForOf"],["icon","times",3,"iconClick","colorFrom"],[1,"color-weight-400"],[1,"button-small","mt-1",3,"click"],["shape","plus"],[3,"entity"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["formGroupName","customFields",3,"title"],["entityName","Customer",3,"customFields","customFieldsFormGroup"],[3,"to-delete","availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable","setAsDefaultBilling","setAsDefaultShipping","deleteAddress",4,"ngFor","ngForOf"],["class","btn btn-secondary mt-2",3,"click",4,"vdrIfPermissions"],[3,"title","paddingX"],["id","customer-order-list",3,"itemsPerPageChange","pageChange","items","itemsPerPage","totalItems","currentPage","emptyStateLabel"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault"],["id","code",3,"heading","optional"],["id","order-type",3,"heading","hiddenByDefault"],["id","state",3,"heading"],["id","total",3,"heading"],["id","updated-at",3,"heading"],["id","placed-at",3,"heading"],[3,"customField",4,"ngFor","ngForOf"],[3,"addNote","updateNote","deleteNote","customer","history"],[3,"setAsDefaultBilling","setAsDefaultShipping","deleteAddress","availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","editable"],[1,"btn","btn-secondary","mt-2",3,"click"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"state"],[3,"customField"]],template:function(i,n){if(i&1&&(l(0,"vdr-page-block")(1,"vdr-action-bar"),C(2,"vdr-ab-left"),l(3,"vdr-ab-right"),C(4,"vdr-action-bar-items",2),_(5,Sn,3,4,"button",3),a(6,"async"),_(7,Tn,1,1,"ng-template",null,0,q),C(9,"vdr-action-bar-dropdown-menu",2),m()()(),l(10,"vdr-page-detail-layout")(11,"vdr-page-detail-sidebar"),_(12,En,3,2,"vdr-card",4),a(13,"async"),_(14,Gn,7,6,"vdr-card",5),a(15,"async"),l(16,"vdr-card"),_(17,$n,1,1,"vdr-page-entity-info",6),a(18,"async"),m()(),l(19,"vdr-page-block")(20,"form",7)(21,"vdr-card")(22,"div",8)(23,"vdr-form-field",9),a(24,"translate"),a(25,"async"),C(26,"input",10),m(),C(27,"div"),l(28,"vdr-form-field",11),a(29,"translate"),a(30,"async"),C(31,"input",12),m(),l(32,"vdr-form-field",13),a(33,"translate"),a(34,"async"),C(35,"input",14),m(),l(36,"vdr-form-field",15),a(37,"translate"),a(38,"async"),C(39,"input",16),m(),l(40,"vdr-form-field",17),a(41,"translate"),a(42,"async"),C(43,"input",18),m(),_(44,Nn,3,3,"vdr-form-field",19),a(45,"async"),m()(),_(46,kn,3,5,"vdr-card",20),m(),C(47,"vdr-custom-detail-component-host",21),_(48,zn,42,58,"ng-container",4),a(49,"async"),m()()),i&2){let c,f=j(8);r(5),o("ngIf",d(6,21,n.isNew$))("ngIfElse",f),r(7),o("ngIf",d(13,23,n.entity$)),r(2),o("ngIf",(c=d(15,25,n.entity$))==null?null:c.groups),r(3),o("ngIf",d(18,27,n.entity$)),r(3),o("formGroup",n.detailForm.get("customer")),r(3),o("label",d(24,29,"customer.title"))("readOnlyToggle",!d(25,31,n.isNew$)),r(5),o("label",d(29,33,"customer.first-name"))("readOnlyToggle",!d(30,35,n.isNew$)),r(4),o("label",d(33,37,"customer.last-name"))("readOnlyToggle",!d(34,39,n.isNew$)),r(4),o("label",d(37,41,"customer.email-address"))("readOnlyToggle",!d(38,43,n.isNew$)),r(4),o("label",d(41,45,"customer.phone-number"))("readOnlyToggle",!d(42,47,n.isNew$)),r(4),o("ngIf",d(45,49,n.isNew$)),r(2),o("ngIf",n.customFields.length),r(),o("entity$",n.entity$)("detailForm",n.detailForm),r(),o("ngIf",!d(49,51,n.isNew$))}},dependencies:[U,te,O,Te,ae,K,se,le,Ee,Fe,oe,fe,ge,Ce,xe,ue,Ae,pe,pi,ot,J,_e,Ge,mt,ve,he,ke,ye,at,st,lt,dt,ht,wr,$r,V,$,$e,gi,ce,ii],styles:[".last-login[_ngcontent-%COMP%]{margin-inline-start:6px;color:var(--color-grey-500)}.to-delete[_ngcontent-%COMP%]{opacity:.5}"],changeDetection:0})}}return t})(),co=re`
    query GetCustomerGroupDetail($id: ID!) {
        customerGroup(id: $id) {
            ...CustomerGroupDetail
        }
    }
    fragment CustomerGroupDetail on CustomerGroup {
        id
        createdAt
        updatedAt
        name
    }
`,kr=(()=>{class t extends ct{constructor(e,i,n,c){super(),this.formBuilder=e,this.dataService=i,this.modalService=n,this.notificationService=c,this.customFields=this.getCustomFieldConfig("CustomerGroup"),this.detailForm=this.formBuilder.group({name:"",customFields:this.formBuilder.group(Le(this.customFields))})}ngOnInit(){super.init()}create(){let e=this.detailForm.value;e.name&&this.dataService.customer.createCustomerGroup({name:e.name,customFields:e.customFields,customerIds:[]}).subscribe(({createCustomerGroup:i})=>{this.notificationService.success("common.notify-create-success",{entity:"CustomerGroup"}),this.detailForm.markAsPristine(),this.router.navigate(["../",i.id],{relativeTo:this.route})},i=>{this.notificationService.error("common.notify-create-error",{entity:"CustomerGroup"})})}save(){let e=this.detailForm.value;this.dataService.customer.updateCustomerGroup(N({id:this.id},e)).subscribe(()=>{this.notificationService.success("common.notify-update-success",{entity:"CustomerGroup"}),this.detailForm.markAsPristine()},i=>{this.notificationService.error("common.notify-update-error",{entity:"CustomerGroup"})})}setFormValues(e){if(this.detailForm.patchValue({name:e.name}),this.customFields.length){let i=this.detailForm.get(["customFields"]);this.setCustomFieldFormValues(this.customFields,this.detailForm.get("customFields"),e)}}static{this.\u0275fac=function(i){return new(i||t)(x(Ze),x(L),x(W),x(X))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-group-detail"]],standalone:!1,features:[Z],decls:23,vars:14,consts:[["updateButton",""],["locationId","customer-group-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],[1,"form",3,"formGroup"],[4,"ngIf"],[1,"form-grid"],["for","name",3,"label"],["id","name","type","text","formControlName","name"],["formGroupName","customFields",3,"title",4,"ngIf"],["locationId","customer-group-detail",3,"entity$","detailForm"],[1,"btn","btn-primary",3,"click","disabled"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"entity"],["formGroupName","customFields",3,"title"],["entityName","CustomerGroup",3,"customFields","customFieldsFormGroup"]],template:function(i,n){if(i&1&&(l(0,"vdr-page-block")(1,"vdr-action-bar"),C(2,"vdr-ab-left"),l(3,"vdr-ab-right"),C(4,"vdr-action-bar-items",1),_(5,Yn,3,4,"button",2),a(6,"async"),_(7,Xn,1,1,"ng-template",null,0,q),C(9,"vdr-action-bar-dropdown-menu",1),m()()(),l(10,"form",3)(11,"vdr-page-detail-layout")(12,"vdr-page-detail-sidebar"),_(13,Jn,2,1,"vdr-card",4),a(14,"async"),m(),l(15,"vdr-page-block")(16,"vdr-card")(17,"div",5)(18,"vdr-form-field",6),a(19,"translate"),C(20,"input",7),m()()(),_(21,Zn,3,5,"vdr-card",8),C(22,"vdr-custom-detail-component-host",9),m()()()),i&2){let c=j(8);r(5),o("ngIf",d(6,8,n.isNew$))("ngIfElse",c),r(5),o("formGroup",n.detailForm),r(3),o("ngIf",d(14,10,n.entity$)),r(5),o("label",d(19,12,"common.name")),r(3),o("ngIf",n.customFields.length),r(),o("entity$",n.entity$)("detailForm",n.detailForm)}},dependencies:[O,Te,ae,K,se,le,Ee,Fe,fe,ge,Ce,xe,Ae,pe,J,_e,Ge,mt,ye,at,st,lt,dt,V,$],encapsulation:2,changeDetection:0})}}return t})(),uo=(()=>{class t{constructor(e,i){this.serverConfigService=e,this.formBuilder=i,this.customFields=this.serverConfigService.getCustomFieldsFor("CustomerGroup")}ngOnInit(){if(this.form=this.formBuilder.group({name:[this.group.name,R.required],customFields:this.formBuilder.group(Le(this.customFields))}),this.customFields.length){let e=this.form.get("customFields");for(let i of this.customFields){let n=i.name,c=this.group.customFields?.[n],f=e.get(n);f&&f.patchValue(c)}}}cancel(){this.resolveWith()}save(){this.resolveWith(this.form.value)}static{this.\u0275fac=function(i){return new(i||t)(x(ti),x(qt))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-group-detail-dialog"]],standalone:!1,decls:8,vars:9,consts:[["vdrDialogTitle",""],[3,"formGroup"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly"],["formGroupName","customFields",4,"ngIf"],["vdrDialogButtons",""],[4,"ngIf"],["formGroupName","customFields"],["entityName","CustomerGroup",3,"customFields","customFieldsFormGroup"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&(_(0,nr,2,2,"ng-template",0),l(1,"form",1)(2,"vdr-form-field",2),a(3,"translate"),C(4,"input",3),a(5,"hasPermission"),m(),_(6,rr,5,5,"section",4),m(),_(7,sr,6,6,"ng-template",5)),i&2&&(r(),o("formGroup",n.form),r(),o("label",d(3,4,"common.name")),r(2),o("readonly",!d(5,6,ee(8,er))),r(2),o("ngIf",n.customFields.length))},dependencies:[Wt,O,Te,ae,K,se,le,Ee,Fe,Ae,pe,de,me,Ge,$,$e],encapsulation:2,changeDetection:0})}}return t})(),Mr=gt({location:"customer-group-list",requiresPermission:t=>t.includes(Be.DeleteCustomerGroup),getItemName:t=>t.name,bulkDelete:(t,s)=>t.customer.deleteCustomerGroups(s).pipe(F(e=>e.deleteCustomerGroups))}),_o=re`
    query GetCustomerGroupList($options: CustomerGroupListOptions) {
        customerGroups(options: $options) {
            items {
                ...CustomerGroup
            }
            totalItems
        }
    }
    ${ei}
`,Or=(()=>{class t extends _t{constructor(e,i,n,c,f){super(),this.dataService=e,this.notificationService=i,this.modalService=n,this.route=c,this.router=f,this.dataTableListId="customer-group-list",this.customFields=this.getCustomFieldConfig("CustomerGroup"),this.fetchGroupMembers$=new Y({skip:0,take:0,filterTerm:""}),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"name",type:{kind:"text"},label:"common.name",filterField:"name"}).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"name"}).connectToRoute(this.route),this.refreshActiveGroupMembers$=new Y(void 0),super.configure({document:Xt,getItems:b=>b.customerGroups,setVariables:(b,B)=>({options:{skip:b,take:B,filter:N({name:{contains:this.searchTermControl.value}},this.filters.createFilterInput()),sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.filters.valueChanges,this.sorts.valueChanges]})}ngOnInit(){super.ngOnInit();let e=this.route.paramMap.pipe(F(n=>n.get("contents")),Ie());this.listIsEmpty$=this.items$.pipe(F(n=>n.length===0)),this.activeGroup$=ie(this.items$,e).pipe(F(([n,c])=>{if(c)return n.find(f=>f.id===c)})),this.activeIndex$=ie(this.items$,e).pipe(F(([n,c])=>c?n.findIndex(f=>f.id===c):-1));let i=ie(this.activeGroup$,this.fetchGroupMembers$,this.refreshActiveGroupMembers$).pipe(M(([n,{skip:c,take:f,filterTerm:b}])=>n?this.dataService.customer.getCustomerGroupWithCustomers(n.id,{skip:c,take:f,filter:{emailAddress:{contains:b}}}).mapStream(B=>B.customerGroup?.customers):kt(void 0)));this.members$=i.pipe(F(n=>n?.items??[])),this.membersTotal$=i.pipe(F(n=>n?.totalItems??0))}closeMembers(){let e=N({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToGroup(e){this.modalService.fromComponent(Br,{locals:{group:e,route:this.route},size:"md",verticalAlign:"top"}).pipe(M(i=>i?this.dataService.customer.addCustomersToGroup(e.id,i).pipe(Nt(i)):z)).subscribe({next:i=>{this.notificationService.success("customer.add-customers-to-group-success",{customerCount:i.length,groupName:e.name}),this.refreshActiveGroupMembers$.next()}})}static{this.\u0275fac=function(i){return new(i||t)(x(L),x(X),x(W),x(Rt),x(Ke))}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-group-list"]],standalone:!1,features:[Z],decls:12,vars:7,consts:[["locationId","customer-group-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"closeClicked","rightPanelOpen"],["vdrSplitViewLeft",""],["vdrSplitViewRight","",3,"splitViewTitle"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"mt-2",3,"pageChange","itemsPerPageChange","visibleColumnsChange","id","items","itemsPerPage","totalItems","currentPage","filters","activeIndex"],["locationId","customer-group-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","name",3,"heading","optional","sort"],[3,"customField","sorts",4,"ngFor","ngForOf"],["id","view-contents",3,"heading","optional"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customField","sorts"],["queryParamsHandling","preserve",1,"button-small","bg-weight-150",3,"routerLink"],["shape","file-group"],[4,"ngIf"],[1,"button-ghost","ml-4",3,"click"],["locationId","customer-group-members-list",3,"fetchParamsChange","members","route","totalItems","activeGroup"]],template:function(i,n){if(i&1&&(l(0,"vdr-page-block")(1,"vdr-action-bar"),C(2,"vdr-ab-left"),l(3,"vdr-ab-right"),C(4,"vdr-action-bar-items",0),_(5,mr,4,5,"a",1),C(6,"vdr-action-bar-dropdown-menu",0),m()()(),l(7,"vdr-split-view",2),a(8,"async"),y("closeClicked",function(){return n.closeMembers()}),_(9,fr,25,47,"ng-template",3)(10,vr,2,3,"ng-template",4),a(11,"async"),m()),i&2){let c;r(5),o("vdrIfPermissions","CreateCustomerGroup"),r(2),o("rightPanelOpen",d(8,3,n.activeGroup$)),r(3),o("splitViewTitle",(c=d(11,5,n.activeGroup$))==null?null:c.name)}},dependencies:[U,te,O,oe,fe,ge,Ce,xe,J,_e,Ne,ve,he,Me,ke,_i,ci,ui,ye,bi,V,$,ce],styles:["vdr-empty-placeholder[_ngcontent-%COMP%]{flex:1}"],changeDetection:0})}}return t})(),Lr={location:"customer-group-members-list",label:"customer.remove-from-group",icon:"trash",iconClass:"is-danger",requiresPermission:Be.UpdateCustomerGroup,onClick:({injector:t,selection:s,hostComponent:e,clearSelection:i})=>{let n=t.get(W),c=t.get(L),f=t.get(X),b=e.activeGroup,B=s.map(G=>G.id);c.customer.removeCustomersFromGroup(b.id,B).subscribe({complete:()=>{f.success("customer.remove-customers-from-group-success",{customerCount:B.length,groupName:b.name}),i(),e.refresh()}})}},Vr=gt({location:"customer-list",requiresPermission:t=>t.includes(Be.DeleteCustomer),getItemName:t=>t.firstName+" "+t.lastName,bulkDelete:(t,s)=>t.customer.deleteCustomers(s).pipe(F(e=>e.deleteCustomers))}),go=re`
    query CustomerListQuery($options: CustomerListOptions) {
        customers(options: $options) {
            items {
                ...CustomerListItem
            }
            totalItems
        }
    }

    fragment CustomerListItem on Customer {
        id
        createdAt
        updatedAt
        title
        firstName
        lastName
        emailAddress
        user {
            id
            verified
        }
    }
`,Rr=(()=>{class t extends _t{constructor(){super(),this.dataTableListId="customer-list",this.customFields=this.getCustomFieldConfig("Customer"),this.filters=this.createFilterCollection().addIdFilter().addDateFilters().addFilter({name:"firstName",type:{kind:"text"},label:"customer.first-name",filterField:"firstName"}).addFilter({name:"lastName",type:{kind:"text"},label:"customer.last-name",filterField:"lastName"}).addFilter({name:"emailAddress",type:{kind:"text"},label:"customer.email-address",filterField:"emailAddress"}).addCustomFieldFilters(this.customFields).connectToRoute(this.route),this.sorts=this.createSortCollection().defaultSort("createdAt","DESC").addSort({name:"createdAt"}).addSort({name:"updatedAt"}).addSort({name:"lastName"}).addSort({name:"emailAddress"}).addCustomFieldSorts(this.customFields).connectToRoute(this.route),this.configure({document:Jt,getItems:e=>e.customers,setVariables:(e,i)=>({options:{skip:e,take:i,filter:N(N({},this.searchTermControl.value?{emailAddress:{contains:this.searchTermControl.value},lastName:{contains:this.searchTermControl.value},postalCode:{contains:this.searchTermControl.value}}:{}),this.filters.createFilterInput()),filterOperator:this.searchTermControl.value?et.OR:et.AND,sort:this.sorts.createSortInput()}}),refreshListOnChanges:[this.sorts.valueChanges,this.filters.valueChanges]})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["vdr-customer-list"]],standalone:!1,features:[Z],decls:34,vars:48,consts:[["locationId","customer-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[1,"mt-2",3,"pageChange","itemsPerPageChange","visibleColumnsChange","id","items","itemsPerPage","totalItems","currentPage","filters"],["locationId","customer-list",3,"hostComponent","selectionManager"],[3,"searchTermControl","searchTermPlaceholder"],["id","id",3,"heading","hiddenByDefault"],["id","created-at",3,"heading","hiddenByDefault","sort"],["id","updated-at",3,"heading","hiddenByDefault","sort"],["id","name",3,"heading","optional","sort"],["id","status",3,"heading"],["id","email-address",3,"heading","sort"],[3,"customField","sorts",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"button-ghost",3,"routerLink"],["shape","arrow right"],[3,"customer"],[3,"customField","sorts"]],template:function(i,n){i&1&&(l(0,"vdr-page-block")(1,"vdr-action-bar"),C(2,"vdr-ab-left"),l(3,"vdr-ab-right"),C(4,"vdr-action-bar-items",0),_(5,br,4,5,"a",1),C(6,"vdr-action-bar-dropdown-menu",0),m()()(),l(7,"vdr-data-table-2",2),a(8,"async"),a(9,"async"),a(10,"async"),a(11,"async"),y("pageChange",function(f){return n.setPageNumber(f)})("itemsPerPageChange",function(f){return n.setItemsPerPage(f)})("visibleColumnsChange",function(f){return n.setVisibleColumns(f)}),C(12,"vdr-bulk-action-menu",3)(13,"vdr-dt2-search",4),a(14,"translate"),l(15,"vdr-dt2-column",5),a(16,"translate"),_(17,xr,1,1,"ng-template"),m(),l(18,"vdr-dt2-column",6),a(19,"translate"),_(20,Dr,2,4,"ng-template"),m(),l(21,"vdr-dt2-column",7),a(22,"translate"),_(23,Sr,2,4,"ng-template"),m(),l(24,"vdr-dt2-column",8),a(25,"translate"),_(26,Ir,4,6,"ng-template"),m(),l(27,"vdr-dt2-column",9),a(28,"translate"),_(29,Tr,1,1,"ng-template"),m(),l(30,"vdr-dt2-column",10),a(31,"translate"),_(32,Fr,1,1,"ng-template"),m(),_(33,Er,1,2,"vdr-dt2-custom-field-column",11),m()),i&2&&(r(5),o("vdrIfPermissions","CreateCustomer"),r(2),o("id",n.dataTableListId)("items",d(8,26,n.items$))("itemsPerPage",d(9,28,n.itemsPerPage$))("totalItems",d(10,30,n.totalItems$))("currentPage",d(11,32,n.currentPage$))("filters",n.filters),r(5),o("hostComponent",n)("selectionManager",n.selectionManager),r(),o("searchTermControl",n.searchTermControl)("searchTermPlaceholder",d(14,34,"customer.search-customers-by-email-last-name-postal-code")),r(2),o("heading",d(16,36,"common.id"))("hiddenByDefault",!0),r(3),o("heading",d(19,38,"common.created-at"))("hiddenByDefault",!0)("sort",n.sorts.get("createdAt")),r(3),o("heading",d(22,40,"common.updated-at"))("hiddenByDefault",!0)("sort",n.sorts.get("updatedAt")),r(3),o("heading",d(25,42,"customer.name"))("optional",!1)("sort",n.sorts.get("lastName")),r(3),o("heading",d(28,44,"common.status")),r(3),o("heading",d(31,46,"customer.email-address"))("sort",n.sorts.get("emailAddress")),r(3),o("ngForOf",n.customFields))},dependencies:[U,te,oe,fe,ge,Ce,xe,J,_e,Ne,ve,he,Me,ke,ye,ht,V,$,ce],styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]})}}return t})(),Ur=t=>[{path:"customers",component:be,data:{locationId:"customer-list",breadcrumb:"breadcrumb.customers"},children:t.getPageTabRoutes("customer-list")},{path:"customers/:id",component:be,data:{locationId:"customer-detail",breadcrumb:{label:"breadcrumb.customers",link:["../","customers"]}},children:t.getPageTabRoutes("customer-detail")},{path:"groups",component:be,data:{locationId:"customer-group-list",breadcrumb:"breadcrumb.customer-groups"},children:t.getPageTabRoutes("customer-group-list")},{path:"groups/:id",component:be,data:{locationId:"customer-group-detail",breadcrumb:{label:"breadcrumb.customer-groups",link:["../","groups"]}},children:t.getPageTabRoutes("customer-group-detail")}];function Co(t,s){return fi({entity:t.entity,id:s.id,breadcrumbKey:"breadcrumb.customers",getName:e=>`${e.firstName} ${e.lastName}`,route:"customers"})}var fo=(()=>{class t{static{this.hasRegisteredTabsAndBulkActions=!1}constructor(e,i){t.hasRegisteredTabsAndBulkActions||(e.registerBulkAction(Vr),e.registerBulkAction(Mr),e.registerBulkAction(Lr),i.registerPageTab({priority:0,location:"customer-list",tab:"customer.customers",route:"",component:Rr}),i.registerPageTab({priority:0,location:"customer-detail",tab:"customer.customer",route:"",component:ut({component:Nr,query:we,entityKey:"customer",variables:{orderListOptions:{sort:{orderPlacedAt:Pe.DESC}}},getBreadcrumbs:n=>[{label:n?`${n?.firstName} ${n?.lastName}`:"customer.create-new-customer",link:[n?.id]}]})}),i.registerPageTab({priority:0,location:"customer-group-list",tab:"customer.customer-groups",route:"",component:Or}),i.registerPageTab({priority:0,location:"customer-group-detail",tab:"customer.customer-group",route:"",component:ut({component:kr,query:Kt,entityKey:"customerGroup",getBreadcrumbs:n=>[{label:n?n.name:"customer.create-new-customer-group",link:[n?.id]}]})}),t.hasRegisteredTabsAndBulkActions=!0)}static{this.\u0275fac=function(i){return new(i||t)(Ue(si),Ue(Oe))}}static{this.\u0275mod=Dt({type:t})}static{this.\u0275inj=yt({providers:[{provide:Ut,useFactory:e=>Ur(e),multi:!0,deps:[Oe]}],imports:[Ci,Ht.forChild([])]})}}return t})();export{Br as AddCustomerToGroupDialogComponent,wr as AddressCardComponent,Pr as AddressDetailDialogComponent,po as CUSTOMER_DETAIL_QUERY,co as CUSTOMER_GROUP_DETAIL_QUERY,go as CUSTOMER_LIST_QUERY,Nr as CustomerDetailComponent,kr as CustomerGroupDetailComponent,uo as CustomerGroupDetailDialogComponent,Or as CustomerGroupListComponent,bi as CustomerGroupMemberListComponent,$r as CustomerHistoryComponent,Gr as CustomerHistoryEntryHostComponent,Rr as CustomerListComponent,fo as CustomerModule,ht as CustomerStatusLabelComponent,_o as GET_CUSTOMER_GROUP_LIST,Ar as SelectCustomerGroupDialogComponent,Ur as createRoutes,Co as customerBreadcrumb,Mr as deleteCustomerGroupsBulkAction,Vr as deleteCustomersBulkAction,Lr as removeCustomerGroupMembersBulkAction};
//# sourceMappingURL=chunk-QZ4FQNYU.js.map
